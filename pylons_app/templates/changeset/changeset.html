<%inherit file="/base/base.html"/>

<%def name="title()">
    ${_('Changeset')}
</%def>

<%def name="breadcrumbs_links()">
    ${h.link_to(u'Home',h.url('/'))}
    &raquo;
    ${h.link_to(c.repo_name,h.url('summary_home',repo_name=c.repo_name))}
    &raquo;
    ${_('Changeset')} - r${c.changeset.revision}:${c.changeset.raw_id}
</%def>

<%def name="page_nav()">
    ${self.menu('changelog')}     
</%def>

<%def name="main()">
<div class="box">
    <!-- box / title -->
    <div class="title">
        ${self.breadcrumbs()}
    </div>
    <div class="table">
    <div id="changeset_content">
		<div class="container">
			<div class="left">
				<div class="date">${_('Date')}: ${c.changeset.date}</div>
				<div class="author">${_('Author')}: ${c.changeset.author}</div>
				<div class="message">${h.wrap_paragraphs(c.changeset.message)}</div>
			</div>	
			<div class="right">
				<span class="logtags">
					<span class="branchtag">${c.changeset.branch}</span>
					%for tag in c.changeset.tags:
						<span class="tagtag">${tag}</span>
					%endfor
				</span>					
				%if len(c.changeset.parents)>1:
				<div class="merge">		
				${_('merge')}
				<img alt="merge" src="/images/icons/arrow_join.png">
				</div>
				%endif						
				%for p_cs in reversed(c.changeset.parents):
					<div class="parent">${_('Parent')} ${p_cs.revision}: ${h.link_to(p_cs.raw_id,
						h.url('changeset_home',repo_name=c.repo_name,revision=p_cs.raw_id),title=p_cs.message)}
					</div>
				%endfor								
			</div>		
		</div>
		<span style="font-size:1.1em;font-weight: bold">${_('Files affected')}</span>
	    <div class="cs_files">
				%for change,filenode,diff,cs1,cs2 in c.changes:
					<div class="cs_${change}">${h.link_to(filenode.path,h.url.current(anchor='CHANGE-%s'%filenode.path))}</div>
				%endfor
		</div>		    
    </div>
    	
	%for change,filenode,diff,cs1,cs2 in c.changes:
		%if change !='removed':
		<div style="clear:both;height:10px"></div>
		<div id="body" class="diffblock">
			<div id="${'CHANGE-%s'%filenode.path}" class="code-header">
				<div>
					<span>
						${h.link_to_if(change!='removed',filenode.path,h.url('files_home',repo_name=c.repo_name,
						revision=filenode.changeset.raw_id,f_path=filenode.path))}
					</span>
					%if 1:
					&raquo; <span>${h.link_to(_('diff'),
					h.url('files_diff_home',repo_name=c.repo_name,f_path=filenode.path,diff2=cs2,diff1=cs1,diff='diff'))}</span>
					&raquo; <span>${h.link_to(_('raw diff'),
					h.url('files_diff_home',repo_name=c.repo_name,f_path=filenode.path,diff2=cs2,diff1=cs1,diff='raw'))}</span>
					&raquo; <span>${h.link_to(_('download diff'),
					h.url('files_diff_home',repo_name=c.repo_name,f_path=filenode.path,diff2=cs2,diff1=cs1,diff='download'))}</span>
					%endif
				</div>
			</div>
			<div class="code-body">        
					%if diff:
						${diff|n}
					%else:
						${_('No changes in this file')}
					%endif
			</div>
		</div>
		%endif
	%endfor 
    </div>
</div>    
	
</%def>