## -*- coding: utf-8 -*-
<%!
from pylons_app.lib import filters
%>
<%inherit file="base/base.html"/>
<%def name="title()">
    ${c.repos_prefix} Mercurial Repositories
</%def>
<%def name="breadcrumbs()">
	${c.repos_prefix} Mercurial Repositories
</%def>
<%def name="page_nav()">
	${self.menu('home')}
</%def>
<%def name="main()">
	<%def name="get_sort(name)">
		<%name_slug = name.lower().replace(' ','_') %>
		%if name_slug == c.cs_slug:
			<span style="font-weight: bold;color:#006699">${name}</span>
		%else:
			<span style="font-weight: bold">${name}</span>
		%endif
		<a href="?sort=${name_slug}">&darr;</a>
		<a href="?sort=-${name_slug}">&uarr;</a>
	</%def>
	<table>
	  <tr>
	    <td>${get_sort(_('Name'))}</td>
	    <td>${get_sort(_('Description'))}</td>
	    <td>${get_sort(_('Last change'))}</td>
	    <td>${get_sort(_('Tip'))}</td>
	    <td>${get_sort(_('Contact'))}</td>
	    <td></td>
	    <td></td>
	    <td></td>
	  </tr>	
	%for cnt,repo in enumerate(c.repos_list):
 		<tr class="parity${cnt%2}">
		    <td>${h.link(repo['name'],h.url('summary_home',repo_name=repo['name']))}</td>
		    <td title="${repo['description']}">${h.truncate(repo['description'],60)}</td>
	        <td>${repo['last_change']|n,filters.age}</td>
	        <td>${h.link_to('r%s:%s' % (repo['rev'],repo['tip']),h.url('changeset_home',repo_name=repo['name'],revision=repo['tip']))}</td>
	        <td title="${repo['contact']}">${repo['contact']|n,filters.person}</td>
	        
	        	##%for archive in repo['repo_archives']:
	        	##<td class="indexlinks">
	        	##	${h.link_to(archive['type'],
       			##	h.url('files_archive_home',repo_name=repo['name'],
       			##	revision='tip',fileformat=archive['extension']),class_="archive_logo" )}
				##</td>
				##%endfor
	        
			<td>
				${h.link_to(_('RSS'),h.url('rss_feed_home',repo_name=repo['name']),class_='rss_logo')}
			</td>        
			<td>
				${h.link_to(_('Atom'),h.url('atom_feed_home',repo_name=repo['name']),class_='atom_logo')}
			</td>
		</tr>
	%endfor
	</table>
</%def>    
